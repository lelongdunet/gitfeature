#!/bin/bash
#This script allows to easilly install gitfeature as a normal user.
#You're supposed to use gitfeature from bash interpreter

set -e

cd "$(dirname "$0")"

function yesno()
{
    DEFAULT=$2
    if [ "$DEFAULT" == "n" ]; then
        CHECK="y"
        echo "$1 [N/y]"
    else
        CHECK="n"
        echo "$1 [n/Y]"
    fi  

    read YESNO
    if [ "$YESNO" == "$CHECK" ]; then
        return 1
    fi  
    return 0
}

function check_python()
{
    if ! python -c "import $1" 2> /dev/null ; then
        echo "> Python package $1 not found, you must install it"
        echo "      On debian-like distrib you should get it by installing package"
        echo "      $2"
        export PYTHON_FAIL=1
        export MISS_DEB="$MISS_DEB $2"
    fi
}

mkdir -p "$HOME/.gitfeature"
cp -a * "$HOME/.gitfeature"
git rev-parse HEAD > "$HOME/.gitfeature/shaver"

if ! egrep 'source .*/.gitfeature/complete/gitfeature.bash' $HOME/.bashrc; then
    echo '#FOLLOWING LINE ARE GENERATED BY GITFEATURE INSTALLER :' >> $HOME/.bashrc
    echo 'test -d $HOME/.gitfeature/complete && source $HOME/.gitfeature/complete/gitfeature.bash' >> $HOME/.bashrc
    echo 'export PATH=$PATH:$HOME/.gitfeature/bin' >> $HOME/.bashrc
    echo '# ---- END GITFEATURE INITIALISATION ----' >> $HOME/.bashrc
fi



